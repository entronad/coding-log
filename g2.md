# G2

G2 更新数据的方式主要有三种：

- 仅仅是更新图表的数据

  更新数据加刷新用 changeData，更新数据和刷新分离用 source 加 repaint

  chart.changeData(data) 方法 **只支持具备相同数据结构的数据** 进行更新

- 清理所有，重新绘制

  清除用clear 绘制用render

- 使用 DataView 时的更新

---

DataSet是一个独立的库

---

度量scale指将数据映射到[0, 1]区间，它在数据空间到图形空间的转换中十分重要

---

在 G2 中我们按照数值是否连续对数据进行分类：

1. 分类（非连续）数据，又分为有序分类和无序分类；
2. 连续数据，时间也是一种连续数据类型。

根据上述的数据分类方式，G2 提供了不同的度量类型：

| 数据类型       | 度量类型               |
| -------------- | ---------------------- |
| 连续           | linear、log、pow、time |
| 分类（非连续） | cat、timeCat           |

---

目前G2中所有坐标系（coord)都是2维的

---

事件为全小写，图形元素事件以"类别-元素名称:事件"的形式组合

---

G2 的图表可以由多个视图 View 构成，同时各个视图可以拥有各自的数据源，即支持异构数据。在结构上，视图和 chart 相同，拥有自己独立的数据源、坐标系和图层。

Chart 是一种特殊的View，两者之间也有一定的差异：

- View 的功能 Chart 都具有
- Tooltip（提示信息）和 Legend（图例）仅在 Chart 上支持
- Chart 上可以创建 View ，但是 View 不再支持创建子 View

---

数据处理流程：https://www.yuque.com/antv/g2-docs/tutorial-data-flow

---

G2的三个核心库：底层渲染g 

---

google/charts

How to draw a pie

---

在charts_flutter中，PieChart继承自BaseChart，其重写了两个函数：

createCommonChart，通过state返回common.PieChart，其主体是调用了common.PieChart的构造函数

addDefaultInteractions，通过behaviors挂载交互事件

---

BaseChart继承自StatefulWidget，其build函数主要是返回一个ChartContainer。其state为独立的BaseChartState，BaseChart的方法可传入state参数，调用state的方法以便控制state，而通过此参数联系BaseChart和BaseChartState则是通过返回的ChartContainer的chartWidget成员和chartState成员

ChartContainer继承自CustomPaint，其Painter为继承自CustomPainter的ChartContainerCustomPaint，其paint函数由common.BaseChart chart参数提供，paint函数中的canvas为新建的ChartCanvas，它继承自common.ChartCanvas

理解重要的对象：CustomPaint，CustomPainter，Paint，Canvas，先实现一个完全没有事件和动画的

BaseChartState的build方法使用了CustomMultiChildLayout，其子元素需包裹在LayoutId中

ChartContainer继承自CustomPaint，重写createRenderObject，和updateRenderObject方法，其操作对象都是RenderCustomPaint，ChartContainer本身只用来记录cfg，核心逻辑写在继承自RenderCustomPaint的ChartContainerRenderObject中

它的painter称为ChartContainerCustomPaint（反了？）

---

g2、f2区别：

api

2.没有dataSet

3.scale没有log、pow、多了identity

4.geom没有edge和heatmap

5.attr没有opacity

6.坐标系没有theta和helix

行数

f2:11766

g2:17566

g:7727

zrender:18008

echarts:67166